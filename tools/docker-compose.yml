version: '3'
services:
    mysql:
        container_name: mysql
        restart: always
        image: mysql:latest
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: db
            MYSQL_USER: user
            MYSQL_PASSWORD: password
            TZ: Asia/Bangkok
        volumes:
            - /home/kali/Docker/mysql/mysqld.cnf:/etc/mysql/mysql.conf.d/mysqld.cnf
            - /home/kali/Docker/mysql/data:/var/lib/mysql
            - /home/kali/Docker/mysql/my.cnf:/etc/mysql/conf.d/my.cnf
        ports:
            - "3306:3306"
    adminer:
        image: adminer
        restart: always
        ports:
            - 8181:8080
        depends_on:
            - mysql

    portainer:
        image: portainer/portainer-ce:latest
        container_name: portainer
        restart: always
        ports:
        - "8000:8000"   # Agent communication (optional)
        - "9443:9443"   # HTTPS web UI
        volumes:
        - /var/run/docker.sock:/var/run/docker.sock
        - portainer_data:/data
        environment:
        - TZ=UTC  # Set your timezone, e.g. Europe/London
    
    gateway:
        image: nginx:stable-bullseye
        container_name: gateway
        restart: always
        ports:
            - "80:80"
            - "443:443"
        volumes:
            - ./gateway_local:/etc/nginx/

volumes:
  portainer_data:        